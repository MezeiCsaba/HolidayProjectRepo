<!DOCTYPE html>
<html lang="hu" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	layout:decorate="~{layouts/main}">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="">
<meta name="viewport"
	content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="description" content="">

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
	crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.3.1.min.js"
	type="text/javascript"></script>
<script crossorigin="anonymous"
	integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
	type="text/javascript"></script>
<script crossorigin="anonymous"
	integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
	type="text/javascript"></script>
<script crossorigin="anonymous" src="../static/js/main.js"
	th:src="@{../js/main.js}" type="text/javascript"></script>

<title>Felhasználók</title>

</head>

<body>

	<div layout:fragment="loginContent" >
		<div class="container col-lg-11 mt-1">
			<th:block th:if="${newUserError!=null}">
				<div class="modal" tabindex="-1" role="dialog" id="userReg">
					<div class="modal-dialog" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title text-center">Regisztráció</h5>
							</div>
							<div class="modal-body align-center text-center">
								<p class="text-center" th:if="${newUserError}=='regSucces'">Sikeres
									Regisztráció!</p>
								<b class="text-center" th:if="${newUserError}=='regUnSucces'">Ezzel
									az e-mail címmel már létezik felhasználó!</b>
								<p class="text-center" th:if="${newUserError}=='updateSucces'">Sikeres
									adat frissítés!</p>

							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-warning"
									data-dismiss="modal">Close</button>
							</div>
						</div>
					</div>
				</div>
				<script>
					$('#userReg').modal('show');
				</script>
			</th:block>


			<div class="container col-lg-6  justify-content-center">

				<form name="search" th:action="@{/search}" method="POST"
					class="form-inline">
					<div class="input-group mb-3">
						<input type="search" class="form-control" aria-label="serachtext"
							placeholder="felhasználónév" id="serachtext" name="searchtext">
						<div class="input-group-prepend ">
							<button type="submit" style="background-color: yellow" class="input-group-text"
								id="inputGroup-sizing-default">Keresés</button>
						</div>
					</div>
				</form>
			</div>

			<form name="userhandling" th:object="${updateuser}"
				th:action="@{/registration}" method="POST" class="form-group">
				<div
					class="col-lg ms-3 border border-primary rounded-end shadow p-3  bg-white rounded justify-content-center"
					style="width: 1200px; height: 545px; margin: auto;">
					<table class="table table-hover text-center">
						<thead>
							<tr class="justify-content-center">

								
								<th><a  type="button" class="nav-link" id="namew" th:name="namew" th:href="@{/orderBy(orderBy='name', currentPage=${currentPage})}">Név &nabla; </a></th>
								<th><a  type="button" class="nav-link" id="emailw" th:name="emailw" th:href="@{/orderBy(orderBy='email', currentPage=${currentPage})}">E-mail &nabla;</a></th>
								<th><a  type="button" class="nav-link" id="rolew" th:name="rolew" href="#">Jogosultság</a></th>
								<th><a  type="button" class="nav-link" id="statusw" th:name="statusw" th:href="@{/orderBy(orderBy='status', currentPage= ${currentPage})}">Státusz &nabla;</a></th>
								
								<th><a sec:authorize="hasAuthority('ADMIN')" type="button" href="/registration" class="btn btn-success self-align-right">Új felhasználó</a></th>
								<th><a type="button" class="btn btn-secondary self-align-right " th:href="@{/}">
								<strong>Vissza</strong></a></th>
								<th sec:authorize="hasAuthority('HR')"></th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="user: ${users}">
								<td th:style = "(${(user.activationCode==null || user.activationCode.isEmpty()) && user.baseLeave>19} )? 'color: black' : 'color: red' "><span th:text="${user.name}">név</span></td>
								<td><span th:text="${user.email}">email</span></td>
								<td><span th:text="${user.roles}">role</span></td>
								<td><span th:text="${user.status}? 'Aktív': 'Inaktív'">status</span></td>

								<td>
									<button type="submit" id="id" th:name="id"
										class="btn btn-primary px-2" th:field="*{id}" th:value="${user.id}">Edit</button>
								</td>
								<td>
									<a sec:authorize="hasAuthority('HR')" type="button" id="view" th:name="view" th:href="@{/userInfoPage/(user.id=${user.id})}"
										class="btn btn-info px-2" >View</a>
								</td>

							</tr>
						</tbody>
					</table>
					<ul class="nav nav-pills">
						<li class="nav-item"
							th:each="i : ${#numbers.sequence(0,users.totalPages-1)}"><a
							class="nav-link"
							th:classappend="${currentPage}==${i}?'active':''"
							th:href="@{/userhandling/(page=${i})}" th:text="${i+1}"></a></li>
					</ul>
				</div>
			</form>
			<br>

		</div>
	</div>
</body>

</html>